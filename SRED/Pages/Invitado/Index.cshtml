@page
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ver Reportes Enviados</title>
    <link rel="stylesheet" href="../css/Estilos.css" />
</head>
<body id="fijo">
    <header>
        <label for="">Sistema de Reportes de Equipo Dañado</label>
        <span>
            <img class="config-grande"
                 src="../assets/settings-3-fill (1).svg"
                 alt="" />
        </span>
    </header>
    <div id="opcionCerrarSesion">
        <label for="">Cerrar sesión</label>
    </div>
    <main id="principal-encargado">
        <label for="" class="titulo-repEnviados">Reportes enviados:</label>
        <ul id="lista-reportesEncargado">
        </ul>
        <div id="boton-Agregar">
            <a href="/Invitado/SeleccionarLab">
                <img src="../assets/add-line.svg" alt="" />
            </a>
        </div>
    </main>
</body>
</html>

<script>
    let btnCerrarSesion = document.querySelector(".config-grande");
    let opcionCerrarSesion = document.getElementById("opcionCerrarSesion");

    btnCerrarSesion.addEventListener("click", function (e) {
        e.stopPropagation();

        if (opcionCerrarSesion.style.visibility === "hidden") {
            opcionCerrarSesion.style.visibility = "visible";
        } else {
            opcionCerrarSesion.style.visibility = "hidden";
        }
    });

    document.addEventListener("click", function (e) {
        if (opcionCerrarSesion.style.visibility == "visible") {
            opcionCerrarSesion.style.visibility = "hidden";
        }
    });

    async function cargarReportes() {
        const listaReportes = document.getElementById('lista-reportesEncargado');
        listaReportes.innerHTML = '<label>Cargando...</label>';
        try {

            const response = await fetch('https://sredapi.websitos256.com/api/Reporte/pornumerocontrol/201G0276');
            const data = await response.json();
            listaReportes.innerHTML = '';
            data.forEach(aula => {

                const li = document.createElement('li');

                const span = document.createElement("span");
                span.classList.add("estado");

                const div = document.createElement("div");

                const label = document.createElement("label");
                label.classList.add("lbl-estado");
                if (aula.estado == 1) {

                div.classList.add("circuloVerde");
                    label.textContent = "Completado";
                } else {
                    
                    div.classList.add("circuloRojo");
                    label.textContent = "Pendiente";
                    label.style.color = "#FAB12F";
                }

                span.appendChild(div);
                span.appendChild(label);

                const span2 = document.createElement("span");
                span2.classList.add("problema", "rep-enviados");

                const img = document.createElement("img");
                img.src = "../assets/fix.svg";
                img.alt = "";

                const label2 = document.createElement("label");

                label2.textContent = aula.descripcion;
                span2.appendChild(img);
                span2.appendChild(label2);

                const label3 = document.createElement("label");
                label3.classList.add("inf");
                label3.textContent = `${aula.equipo} de ${aula.aula}`;

                li.appendChild(span);
                li.appendChild(span2);
                li.appendChild(label3);
                listaReportes.appendChild(li);
            });

        } catch (error) {
            console.error('Error:', error);
        }
    }

    cargarReportes();
</script>