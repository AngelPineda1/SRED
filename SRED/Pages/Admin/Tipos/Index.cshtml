@page
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ver Tipos</title>
    <link rel="stylesheet" href="~/css//estilos.css" />
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
          rel="stylesheet" />
    <script src="/Index.js" type="module"></script>
</head>
<body id="fijo">
    <header>
        <label for="">Sistema de Reportes de Equipo Dañado</label>
        <span>
            <a href="/Admin/Tipos/AgregarTipo">
                <img class="extra" src="~/assets/add-line.svg" alt="" />
                <img class="icono-grande" src="~/assets/add-line (1).svg" alt="" />
            </a>
            <span>
                <img src="~/assets/settings-3-fill (1).svg"
                     alt=""
                     class="config-chico" />
                <img class="config-grande"
                     src="~/assets/settings-3-line.svg"
                     alt="" />
            </span>
        </span>
        <div id="opcionCerrarSesion">
            <label for="">Cerrar sesión</label>
        </div>
    </header>
    <main id="main-aulas">
        <ul id="lista-Aulas">
           
            <!-- <li>
              <label for="">Laboratorio CCA3</label>
              <i class="fa-solid fa-ellipsis-vertical"></i>
            </li> -->
        </ul>

        <div id="menu-flotante">
            <ul>
                <li>
                    <a href="/Admin/Aulas" class="prueba">
                        <img src="~/assets/person-chalkboard-solid.svg" alt="" />
                    </a>
                    <label for="">Aulas</label>
                </li>
                <li >
                    <a href="/Admin/Equipos">
                        <img src="~/assets/computer-solid.svg" alt="" />
                    </a>
                    <label for="">Equipos</label>
                </li>
                <li class="seleccionado">
                    <a href="/Admin/Tipos">
                        <img src="~/assets/cubes-solid1.svg" alt="" />
                    </a>
                    <label for="" class="selec">Tipos</label>
                </li>
            </ul>
        </div>
    </main>
</body>
</html>
<script>
    async function cargarEquipos() {
        const listaAulas = document.getElementById('lista-Aulas');
        listaAulas.innerHTML = '<label>Cargando...</label>';
        try {
         
            const response = await fetch('https://sredapi.websitos256.com/api/Tipo'); 
            const data = await response.json();
            listaAulas.innerHTML = '';
            data.forEach(aula => {
                
                const li = document.createElement('li');
                li.classList.add('swipe-item');

           
                const revealLeft = document.createElement('div');
                revealLeft.classList.add('reveal-left');
                const editLink = document.createElement('a');
                editLink.href = `/Admin/Tipos/EditarTipo?id=${aula.id}`;
                const editIcon = document.createElement('img');
                editIcon.src = "/assets/pencil-fill.svg";
                editIcon.alt = "editar";
                editLink.appendChild(editIcon);
                revealLeft.appendChild(editLink);

                
                const span = document.createElement('span');
                span.classList = "span-tipo";
                const picture = document.createElement('picture');
                const source = document.createElement('source');
                const mimeType = "image/jpg";
                source.srcset = `data:${mimeType};base64,${aula.icono}`;
                source.type = aula.mimeType; 
                picture.appendChild(source);

       
                const imgFallback = document.createElement('img');
                imgFallback.src = `data:${mimeType};base64,${aula.icono}`;
                imgFallback.alt = "icono"; 
                imgFallback.classList.add("imagen-icono"); 

               
                picture.appendChild(imgFallback);
                const labelNombre = document.createElement('label');
                labelNombre.classList.add('letra-bold');
                labelNombre.textContent = aula.nombre;
              

                span.appendChild(picture);
                span.appendChild(labelNombre);

              
                const revealRight = document.createElement('div');
                revealRight.classList.add('reveal-right');
                const deleteLink = document.createElement('a');
                deleteLink.href = `/Admin/Tipos/Eliminar?id=${aula.id}`;
                const deleteIcon = document.createElement('img');
                deleteIcon.src = "/assets/trash-solid.svg";
                deleteIcon.alt = "elminiar";
                deleteLink.appendChild(deleteIcon);
                revealRight.appendChild(deleteLink);

               
                li.appendChild(span);
                li.appendChild(revealLeft);
                li.appendChild(revealRight);

                
                listaAulas.appendChild(li);
            });
            mostrarOpciones();
        } catch (error) {
            console.error('Error:', error);
        }
    }

   
    cargarEquipos();

    function mostrarOpciones() {
        let elemento = document.querySelectorAll(".swipe-item");

        elemento.forEach((e) => {
            e.addEventListener("click", function () {
                const iconoEditar = e.querySelector(".reveal-left");
                const iconoEliminar = e.querySelector(".reveal-right");

                if (iconoEditar && iconoEliminar) {
                  
                    if (
                        !iconoEditar.style.transition &&
                        !iconoEliminar.style.transition
                    ) {
                        iconoEditar.style.transition = "opacity 0.1s ease-in";
                        iconoEliminar.style.transition = "opacity 0.1s ease-in";
                    }
                    iconoEditar.style.opacity =
                        iconoEditar.style.opacity === "1" ? "0" : "1";
                    iconoEliminar.style.opacity =
                        iconoEliminar.style.opacity === "1" ? "0" : "1";
                }
            });
        });
    }

    let btnCerrarSesionChico = document.querySelector(".config-chico");
    let btnCerrarSesionGrande = document.querySelector(".config-grande");

    let opcionCerrarSesion = document.getElementById("opcionCerrarSesion");

    

    function mostrarCerrarSesion(btnCerrarSesion) {
        if (btnCerrarSesion) {
            btnCerrarSesion.addEventListener("click", function (e) {
                e.stopPropagation();

                if (opcionCerrarSesion.style.visibility === "hidden") {
                    opcionCerrarSesion.style.visibility = "visible";
                } else {
                    opcionCerrarSesion.style.visibility = "hidden";
                }
            });
        }
    }

    function ActualizarBtnCerrarSesion() {
        let btnCerrarSesion = document.getElementById("btn-config");
        mostrarCerrarSesion(btnCerrarSesion);
    }

    document.addEventListener("click", function (e) {
        if (opcionCerrarSesion.style.visibility == "visible") {
            opcionCerrarSesion.style.visibility = "hidden";
        }

        if (e.target == btnCerrarSesionChico) {
            btnCerrarSesionGrande.id = "";
            btnCerrarSesionChico.id = "btn-config";
            ActualizarBtnCerrarSesion();
        } else if (e.target == btnCerrarSesionGrande) {
            btnCerrarSesionGrande.id = "btn-config";
            btnCerrarSesionChico.id = "";
            ActualizarBtnCerrarSesion();
        }
    });

    document.addEventListener("DOMContentLoaded", () => {

        ActualizarBtnCerrarSesion();
    });
</script>

